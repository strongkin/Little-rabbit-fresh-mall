"use strict";(self["webpackChunkerabbit_vue3"]=self["webpackChunkerabbit_vue3"]||[]).push([[58],{7535:function(e,l,s){s.d(l,{AW:function(){return t},GX:function(){return d},Kn:function(){return i},LV:function(){return r},kR:function(){return o},y3:function(){return n}});var a=s(4471);const t=()=>(0,a.Z)("/member/order/pre","get"),d=e=>(0,a.Z)("/member/address","post",e),i=()=>(0,a.Z)("/member/address","get"),n=e=>(0,a.Z)(`/member/address/${e.id}`,"put",e),r=e=>(0,a.Z)("/member/order","post",e),o=e=>(0,a.Z)(`/member/order/${e}`,"get")},6058:function(e,l,s){s.r(l),s.d(l,{default:function(){return Ze}});var a=s(3396),t=s(7139);const d=e=>((0,a.dD)("data-v-65edcd4e"),e=e(),(0,a.Cn)(),e),i={class:"xtx-checkout-page"},n={class:"container"},r=(0,a.Uk)("首页"),o=(0,a.Uk)("购物车"),c=(0,a.Uk)("填写订单"),u={key:0,class:"wrapper"},v=d((()=>(0,a._)("h3",{class:"box-title"},"收货地址",-1))),_={class:"box-body"},p={class:"address"},f={key:0,class:"text"},m=d((()=>(0,a._)("span",null,[(0,a.Uk)("收"),(0,a._)("i"),(0,a.Uk)("货"),(0,a._)("i"),(0,a.Uk)("人：")],-1))),b=d((()=>(0,a._)("span",null,"联系方式：",-1))),y=d((()=>(0,a._)("span",null,"收货地址：",-1))),w={key:1,class:"text"},k=d((()=>(0,a._)("div",{class:"none"},"你需要先添加收货地址才能提交订单",-1))),g=[k],h={class:"action"},x=(0,a.Uk)("切换地址"),U=(0,a.Uk)("添加地址"),C=d((()=>(0,a._)("h3",{class:"box-title"},"商品信息",-1))),D={class:"box-body"},A={class:"goods"},z=d((()=>(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",{width:"520"},"商品信息"),(0,a._)("th",{width:"170"},"单价"),(0,a._)("th",{width:"170"},"数量"),(0,a._)("th",{width:"170"},"小计"),(0,a._)("th",{width:"170"},"实付")])],-1))),W={href:"javascript:;",class:"info"},Z=["src"],V={class:"right"},I=(0,a.uE)('<h3 class="box-title" data-v-65edcd4e>配送时间</h3><div class="box-body" data-v-65edcd4e><a class="my-btn active" href="javascript:;" data-v-65edcd4e>不限送货时间：周一至周日</a><a class="my-btn" href="javascript:;" data-v-65edcd4e>工作日送货：周一至周五</a><a class="my-btn" href="javascript:;" data-v-65edcd4e>双休日、假日送货：周六至周日</a></div><h3 class="box-title" data-v-65edcd4e>支付方式</h3><div class="box-body" data-v-65edcd4e><a class="my-btn active" href="javascript:;" data-v-65edcd4e>在线支付</a><a class="my-btn" href="javascript:;" data-v-65edcd4e>货到付款</a><span style="color:#999;" data-v-65edcd4e>货到付款需付5元手续费</span></div><h3 class="box-title" data-v-65edcd4e>金额明细</h3>',5),X={class:"box-body"},j={class:"total"},H=d((()=>(0,a._)("dt",null,"商品件数：",-1))),L=d((()=>(0,a._)("dt",null,"商品总价：",-1))),P=d((()=>(0,a._)("dt",null,[(0,a.Uk)("运"),(0,a._)("i"),(0,a.Uk)("费：")],-1))),T=d((()=>(0,a._)("dt",null,"应付总额：",-1))),F={class:"price"},B={class:"submit"},E=(0,a.Uk)("提交订单"),K=["onClick"],O=d((()=>(0,a._)("span",null,[(0,a.Uk)("收"),(0,a._)("i"),(0,a.Uk)("货"),(0,a._)("i"),(0,a.Uk)("人：")],-1))),S=d((()=>(0,a._)("span",null,"联系方式：",-1))),$=d((()=>(0,a._)("span",null,"收货地址：",-1))),q=(0,a.Uk)(" 取消 "),G=(0,a.Uk)(" 确认 ");function Y(e,l,s,d,k,Y){const M=(0,a.up)("XtxBreadItem"),R=(0,a.up)("XtxBread"),J=(0,a.up)("XtxButton"),N=(0,a.up)("AddressEdit"),Q=(0,a.up)("XtxDialog");return(0,a.wg)(),(0,a.iD)("div",i,[(0,a._)("div",n,[(0,a.Wm)(R,null,{default:(0,a.w5)((()=>[(0,a.Wm)(M,{to:"/"},{default:(0,a.w5)((()=>[r])),_:1}),(0,a.Wm)(M,{to:"/cart"},{default:(0,a.w5)((()=>[o])),_:1}),(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[c])),_:1})])),_:1}),d.info?((0,a.wg)(),(0,a.iD)("div",u,[v,(0,a._)("div",_,[(0,a._)("div",p,[d.defAddr?((0,a.wg)(),(0,a.iD)("div",f,[(0,a._)("ul",null,[(0,a._)("li",null,[m,(0,a.Uk)((0,t.zw)(d.defAddr.receiver),1)]),(0,a._)("li",null,[b,(0,a.Uk)((0,t.zw)(d.defAddr.contact),1)]),(0,a._)("li",null,[y,(0,a.Uk)((0,t.zw)(d.defAddr.fullLocation+d.defAddr.address),1)])]),(0,a._)("a",{href:"javascript:;",onClick:l[0]||(l[0]=e=>d.openDialog(d.defAddr))},"修改地址")])):((0,a.wg)(),(0,a.iD)("div",w,g)),(0,a._)("div",h,[(0,a.Wm)(J,{class:"btn",onClick:l[1]||(l[1]=e=>d.openSelectDialog())},{default:(0,a.w5)((()=>[x])),_:1}),(0,a.Wm)(J,{class:"btn",onClick:l[2]||(l[2]=e=>d.openDialog({}))},{default:(0,a.w5)((()=>[U])),_:1})])])]),C,(0,a._)("div",D,[(0,a._)("table",A,[z,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(d.info.goods,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.skuId},[(0,a._)("td",null,[(0,a._)("a",W,[(0,a._)("img",{src:e.picture,alt:""},null,8,Z),(0,a._)("div",V,[(0,a._)("p",null,(0,t.zw)(e.name),1),(0,a._)("p",null,(0,t.zw)(e.attrsText),1)])])]),(0,a._)("td",null,"¥"+(0,t.zw)(e.price),1),(0,a._)("td",null,(0,t.zw)(e.count),1),(0,a._)("td",null,"¥"+(0,t.zw)(e.totalPrice),1),(0,a._)("td",null,"¥"+(0,t.zw)(e.totalPayPrice),1)])))),128))])])]),I,(0,a._)("div",X,[(0,a._)("div",j,[(0,a._)("dl",null,[H,(0,a._)("dd",null,(0,t.zw)(d.info.summary.goodsCount)+"件",1)]),(0,a._)("dl",null,[L,(0,a._)("dd",null,"¥"+(0,t.zw)(d.info.summary.totalPrice.toFixed(2)),1)]),(0,a._)("dl",null,[P,(0,a._)("dd",null,"¥"+(0,t.zw)(d.info.summary.postFee.toFixed(2)),1)]),(0,a._)("dl",null,[T,(0,a._)("dd",F," ¥"+(0,t.zw)(d.info.summary.totalPayPrice.toFixed(2)),1)])])]),(0,a._)("div",B,[(0,a.Wm)(J,{type:"primary",onClick:d.submitOrder},{default:(0,a.w5)((()=>[E])),_:1},8,["onClick"])])])):(0,a.kq)("",!0)]),(0,a.Wm)(N,{ref:"dialog",onOnSuccess:d.success},null,8,["onOnSuccess"]),d.info?((0,a.wg)(),(0,a.j4)(Q,{key:0,title:"选择收货地址",visible:d.visibleDialog,"onUpdate:visible":l[4]||(l[4]=e=>d.visibleDialog=e)},{footer:(0,a.w5)((()=>[(0,a.Wm)(J,{onClick:l[3]||(l[3]=e=>d.visibleDialog=!1),type:"gray",style:{"margin-right":"20px"}},{default:(0,a.w5)((()=>[q])),_:1}),(0,a.Wm)(J,{type:"primary",onClick:d.confirm},{default:(0,a.w5)((()=>[G])),_:1},8,["onClick"])])),default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(d.info.userAddresses,(e=>((0,a.wg)(),(0,a.iD)("div",{class:(0,t.C_)(["text item",{active:e.id===d.selectedId}]),onClick:l=>d.selectedId=e.id,key:e.id},[(0,a._)("ul",null,[(0,a._)("li",null,[O,(0,a.Uk)(" "+(0,t.zw)(e.receiver),1)]),(0,a._)("li",null,[S,(0,a.Uk)((0,t.zw)(e.contact),1)]),(0,a._)("li",null,[$,(0,a.Uk)((0,t.zw)(e.fullLocation+e.address),1)])])],10,K)))),128))])),_:1},8,["visible"])):(0,a.kq)("",!0)])}var M=s(7535),R=s(4942),J=s(4870),N=s(678),Q=s(9242);const ee=e=>((0,a.dD)("data-v-6827c8b4"),e=e(),(0,a.Cn)(),e),le={class:"address-edit"},se={class:"xtx-form"},ae={class:"xtx-form-item"},te=ee((()=>(0,a._)("div",{class:"label"},[(0,a._)("i",{class:"red"},"*"),(0,a.Uk)("收货人：")],-1))),de={class:"field"},ie={class:"xtx-form-item"},ne=ee((()=>(0,a._)("div",{class:"label"},[(0,a._)("i",{class:"red"},"*"),(0,a.Uk)("手机号：")],-1))),re={class:"field"},oe={class:"xtx-form-item"},ce=ee((()=>(0,a._)("div",{class:"label"},[(0,a._)("i",{class:"red"},"*"),(0,a.Uk)("地区：")],-1))),ue={class:"field"},ve={class:"xtx-form-item"},_e=ee((()=>(0,a._)("div",{class:"label"},[(0,a._)("i",{class:"red"},"*"),(0,a.Uk)("详细地址：")],-1))),pe={class:"field"},fe={class:"xtx-form-item"},me=ee((()=>(0,a._)("div",{class:"label"},"邮政编码：",-1))),be={class:"field"},ye={class:"xtx-form-item"},we=ee((()=>(0,a._)("div",{class:"label"},"地址标签：",-1))),ke={class:"field"},ge=(0,a.Uk)("取消"),he=(0,a.Uk)("确认");function xe(e,l,s,t,d,i){const n=(0,a.up)("XtxCity"),r=(0,a.up)("XtxButton"),o=(0,a.up)("XtxDialog");return(0,a.wg)(),(0,a.j4)(o,{visible:t.dialogVisible,"onUpdate:visible":l[7]||(l[7]=e=>t.dialogVisible=e),title:(t.form.id?"修改":"添加")+"收货地址"},{footer:(0,a.w5)((()=>[(0,a.Wm)(r,{onClick:l[5]||(l[5]=e=>t.dialogVisible=!1),type:"gray",style:{"margin-right":"20px"}},{default:(0,a.w5)((()=>[ge])),_:1}),(0,a.Wm)(r,{onClick:l[6]||(l[6]=e=>t.submit()),type:"primary"},{default:(0,a.w5)((()=>[he])),_:1})])),default:(0,a.w5)((()=>[(0,a._)("div",le,[(0,a._)("div",se,[(0,a._)("div",ae,[te,(0,a._)("div",de,[(0,a.wy)((0,a._)("input",{class:"input",placeholder:"请输入收货人","onUpdate:modelValue":l[0]||(l[0]=e=>t.form.receiver=e)},null,512),[[Q.nr,t.form.receiver]])])]),(0,a._)("div",ie,[ne,(0,a._)("div",re,[(0,a.wy)((0,a._)("input",{class:"input",placeholder:"请输入手机号","onUpdate:modelValue":l[1]||(l[1]=e=>t.form.contact=e)},null,512),[[Q.nr,t.form.contact]])])]),(0,a._)("div",oe,[ce,(0,a._)("div",ue,[(0,a.Wm)(n,{placeholder:"请选择所在地区",fullLocation:t.form.fullLocation,onChange:t.changeCity},null,8,["fullLocation","onChange"])])]),(0,a._)("div",ve,[_e,(0,a._)("div",pe,[(0,a.wy)((0,a._)("input",{class:"input",placeholder:"请输入详细地址","onUpdate:modelValue":l[2]||(l[2]=e=>t.form.address=e)},null,512),[[Q.nr,t.form.address]])])]),(0,a._)("div",fe,[me,(0,a._)("div",be,[(0,a.wy)((0,a._)("input",{class:"input",placeholder:"请输入邮政编码","onUpdate:modelValue":l[3]||(l[3]=e=>t.form.postalCode=e)},null,512),[[Q.nr,t.form.postalCode]])])]),(0,a._)("div",ye,[we,(0,a._)("div",ke,[(0,a.wy)((0,a._)("input",{class:"input",placeholder:"请输入地址标签，逗号分隔","onUpdate:modelValue":l[4]||(l[4]=e=>t.form.addressTags=e)},null,512),[[Q.nr,t.form.addressTags]])])])])])])),_:1},8,["visible","title"])}var Ue={name:"AddressEdit",emits:["on-success"],setup(e,{emit:l}){const s=(0,J.iH)(!1),a=e=>{t.value={...e},s.value=!0},t=(0,J.iH)({}),d=e=>{for(const l in e)t.value[l]=e[l]},i=async()=>{if(t.value.id)try{await(0,M.y3)(t.value),(0,R.Z)({type:"success",text:"修改收货地址成功"}),l("on-success"),s.value=!1}catch(e){(0,R.Z)({type:"error",text:e.response.data.message||"修改失败"})}else try{t.value.isDefault=1,await(0,M.GX)(t.value),(0,R.Z)({type:"success",text:"添加收货地址成功"}),l("on-success"),s.value=!1}catch(e){(0,R.Z)({type:"error",text:e.response.data.message||"添加失败"})}};return{dialogVisible:s,open:a,form:t,changeCity:d,submit:i}}},Ce=s(89);const De=(0,Ce.Z)(Ue,[["render",xe],["__scopeId","data-v-6827c8b4"]]);var Ae=De,ze={name:"XtxCheckoutPage",components:{AddressEdit:Ae},setup(){const e=(0,J.iH)(null);(0,a.bv)((async()=>{const l=await(0,M.AW)();e.value=l.result,console.log(l.result)}));const l=(0,a.Fl)((()=>{if(o.value)return e.value.userAddresses.find((e=>e.id===o.value));if(e.value&&e.value.userAddresses){const l=e.value.userAddresses.find((e=>0===e.isDefault));return l||e.value.userAddresses[0]}return null})),s=(0,J.iH)(null),t=e=>{s.value.open(e)},d=async()=>{const l=await(0,M.Kn)();e.value.userAddresses=l.result},i=(0,J.iH)(!1),n=()=>{r.value=null,i.value=!0},r=(0,J.iH)(null),o=(0,J.iH)(null),c=()=>{o.value=r.value,i.value=!1},u=(0,N.tv)(),v=async()=>{if(!l.value)return(0,R.Z)({text:"请添加收货地址"});try{const s=await(0,M.LV)({goods:e.value.goods.map((({skuId:e,count:l})=>({skuId:e,count:l}))),addressId:l.value.id,deliveryTimeType:1,payType:1,payChannel:1,buyerMessage:""});u.push(`/user/pay?id=${s.result.id}`)}catch(s){(0,R.Z)({type:"error",text:s.response.data.message||"确认订单失败"})}};return{info:e,defAddr:l,openDialog:t,dialog:s,success:d,visibleDialog:i,openSelectDialog:n,selectedId:r,confirm:c,submitOrder:v}}};const We=(0,Ce.Z)(ze,[["render",Y],["__scopeId","data-v-65edcd4e"]]);var Ze=We}}]);
//# sourceMappingURL=58.a49f8ff4.js.map