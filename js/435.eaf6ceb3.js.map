{"version":3,"file":"js/435.eaf6ceb3.js","mappings":"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","sources":["webpack://erabbit-vue3/./src/api/goods.js","webpack://erabbit-vue3/./src/views/category/index.vue","webpack://erabbit-vue3/./src/views/category/index.vue?2ee1"],"sourcesContent":["import request from '@/utils/request'\r\n/**\r\n * 商品分类\r\n * @param {*} id\r\n * @returns\r\n */\r\nexport const getTopCategory = (id) => request('/category', 'get', { id })\r\n/**\r\n * 搜索商品\r\n * @param {*} params\r\n * @returns\r\n */\r\nexport const getSearchGoods = (params) => request('/search/all', 'psot', params)\r\n/**\r\n * 商品详情\r\n * @param {Number} id 商品id\r\n * @returns\r\n */\r\nexport const getGoods = (id) => request('/goods', 'get', { id })\r\n","<template>\r\n  <div class=\"top-category\">\r\n    <div class=\"contanier\">\r\n      <!-- 面包屑 -->\r\n      <XtxBread>\r\n        <XtxBreadItem to=\"/\">首页</XtxBreadItem>\r\n        <Transition name=\"fade-right\" mode=\"out-in\">\r\n          <XtxBreadItem :key=\"category.id\">{{ category.name }}</XtxBreadItem>\r\n        </Transition>\r\n      </XtxBread>\r\n      <!-- 轮播图 -->\r\n      <XtxCarousel :sliders=\"sliders\" style=\"height: 500px\" />\r\n      <!-- 所有二级分类 -->\r\n      <div class=\"sub-list\">\r\n        <h3>全部分类</h3>\r\n        <ul>\r\n          <li v-for=\"sub in category.children\" :key=\"sub.id\">\r\n            <a href=\"javascript:;\">\r\n              <img :src=\"sub.picture\" />\r\n              <p>{{ sub.name }}</p>\r\n            </a>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n      <!-- 分类关联商品 -->\r\n      <div class=\"ref-goods\" v-for=\"sub in category.children\" :key=\"sub.id\">\r\n        <div class=\"head\">\r\n          <h3>- {{ sub.name }} -</h3>\r\n          <p class=\"tag\">温暖柔软，品质之选</p>\r\n          <XtxMore />\r\n        </div>\r\n        <div class=\"body\">\r\n          <GoodsItem v-for=\"item in sub.goods\" :key=\"item.id\" :goods=\"item\" />\r\n          <div v-if=\"!sub.goods.length\" class=\"none\">暂无商品</div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getTopCategory } from '@/api/goods'\r\nimport { getSliders } from '@/api/home'\r\nimport { onMounted, ref } from 'vue'\r\nimport { onBeforeRouteUpdate, useRoute } from 'vue-router'\r\nexport default {\r\n  name: 'TopCategory',\r\n  setup() {\r\n    const sliders = ref([])\r\n    // 调用API获取数据\r\n    const initSliders = async () => {\r\n      // 实际：获取广告信息的时候传入分类的ID，模拟不同的轮播图数据，随机轮播图数据\r\n      const data = await getSliders()\r\n      // sort(() => Math.random() - 0.5); 打乱数组的顺序\r\n      sliders.value = data.result.sort(() => Math.random() - 0.5)\r\n    }\r\n    onMounted(initSliders)\r\n    // 需求：切换分类的时候 轮播图数据更新（重新发请求）\r\n    // 1. 发现，切换分类的时候，只是参数的改变（id的改变），没有切换路由规则，组件没有更新\r\n    // 2. 需要监听到路由参数的改变，路由提供一个 onBeforeRouteUpdate 监听\r\n    // 3. 三个参数，去哪里路由对象，哪里来路由对象，next()下一步，和beforeEach(全局)相似\r\n    // 4. onBeforeRouteUpdate 仅在当前组件下生效\r\n    onBeforeRouteUpdate((to, from, next) => {\r\n      initSliders()\r\n      next()\r\n    })\r\n\r\n    // 需求：组件初始化，分类切换的时候，获取对应分类数据，渲染面包屑，加上动画\r\n    // 1. 定义API函数\r\n    // 2. 组件初始化获取数据，渲染面包屑\r\n    // 3. 分类切换获取数据,更新数据\r\n    // 4. 加上动画\r\n    const category = ref({})\r\n    // 组合API中获取路由信息对象的 this.$route\r\n    const route = useRoute()\r\n    // 获取地址栏的ID\r\n    const initCategory = async (id) => {\r\n      const data = await getTopCategory(id)\r\n      category.value = data.result\r\n    }\r\n    onMounted(() => {\r\n      initCategory(route.params.id)\r\n    })\r\n    onBeforeRouteUpdate((to, from, next) => {\r\n      // console.log(to.params.id); // 获取切换后分分类ID\r\n      // 获取切换有的ID去发请求\r\n      initCategory(to.params.id)\r\n      next()\r\n    })\r\n\r\n    // 进行渲染\r\n    // 1. 知道商品数据结构，传递商品对象给，单个商品组件\r\n    // 2. 分类页面渲染 全部分类  分类商品\r\n    console.log(category, 'category456')\r\n    return { sliders, category }\r\n  }\r\n  // setup() {\r\n  //   // 获取随机轮播图\r\n  //   const sliders = ref([])\r\n  //   // 获取分类信息\r\n  //   const category = ref({})\r\n  //   const initCategory = async (id) => {\r\n  //     const data = await getTopCategory(id)\r\n  //     category.value = data.result\r\n  //   }\r\n  //   const route = useRoute()\r\n  //   onMounted(() => {\r\n  //     initCategory(route.params.id)\r\n  //   })\r\n  //   const initSliders = async () => {\r\n  //     const data = await getSliders()\r\n  //     sliders.value = data.result.sort(() => Math.random() - 0.5)\r\n  //   }\r\n  //   onMounted(initSliders)\r\n  //   // onMounted(async () => {\r\n  //   //   const data = await getSliders()\r\n  //   //   sliders.value = data.result\r\n  //   // })\r\n  //   onBeforeRouteUpdate((to, from, next) => {\r\n  //     initCategory(to.params.id)\r\n  //     initSliders()\r\n  //     next()\r\n  //   })\r\n  //   return { sliders, category }\r\n  // }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.xtx-category-page {\r\n  h3 {\r\n    font-size: 28px;\r\n    color: #666;\r\n    font-weight: normal;\r\n    text-align: center;\r\n    line-height: 100px;\r\n  }\r\n  .sub-list {\r\n    margin-top: 20px;\r\n    background-color: #fff;\r\n    ul {\r\n      display: flex;\r\n      padding: 0 32px;\r\n      flex-wrap: wrap;\r\n      li {\r\n        width: 168px;\r\n        height: 160px;\r\n        a {\r\n          text-align: center;\r\n          display: block;\r\n          font-size: 16px;\r\n          img {\r\n            width: 100px;\r\n            height: 100px;\r\n          }\r\n          p {\r\n            line-height: 40px;\r\n          }\r\n          &:hover {\r\n            color: var(--xtx-color);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n.ref-goods {\r\n  background-color: #fff;\r\n  margin-top: 20px;\r\n  position: relative;\r\n  .head {\r\n    .xtx-more {\r\n      position: absolute;\r\n      top: 20px;\r\n      right: 20px;\r\n    }\r\n    .tag {\r\n      text-align: center;\r\n      color: #999;\r\n      font-size: 20px;\r\n      position: relative;\r\n      top: -20px;\r\n    }\r\n  }\r\n  .body {\r\n    display: flex;\r\n    justify-content: flex-start;\r\n    flex-wrap: wrap;\r\n    padding: 0 65px 30px;\r\n    .none {\r\n      height: 220px;\r\n      text-align: center;\r\n      width: 100%;\r\n      line-height: 220px;\r\n      color: #999;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import { render } from \"./index.vue?vue&type=template&id=6908e5be&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=6908e5be&lang=less&scoped=true\"\n\nimport exportComponent from \"D:\\\\Users\\\\shuangjian\\\\Desktop\\\\science\\\\Little-rabbit-fresh-mall\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-6908e5be\"]])\n\nexport default __exports__"],"names":["getTopCategory","id","request","getSearchGoods","params","getGoods","class","_createElementVNode","href","_createElementBlock","_createVNode","_component_XtxBread","_component_XtxBreadItem","to","_Transition","name","mode","_createBlock","key","$setup","_component_XtxCarousel","sliders","style","_hoisted_5","_Fragment","_renderList","children","sub","src","picture","_toDisplayString","_hoisted_9","_component_XtxMore","goods","item","_component_GoodsItem","length","setup","ref","initSliders","async","data","getSliders","value","result","sort","Math","random","onMounted","onBeforeRouteUpdate","from","next","category","route","useRoute","initCategory","console","log","__exports__","render"],"sourceRoot":""}